%!TEX root = htm.tex
\section{Related work and discussion}
\label{sec:rel}
%
\vspace{1mm}\noindent\textbf{HyTM implementations and complexity.}
Early HyTMs like the ones described in \cite{damronhytm, kumarhytm} provided progressiveness, but
subsequent HyTM proposals like \emph{PhTM}~\cite{phasedtm} and \emph{HybridNOrec}~\cite{hybridnorec} sacrificed progressiveness for lesser instrumentation overheads.
This instrumentation cost on the fast-path was precisely characterized in \cite{htmdisc15}.
In this paper, we proved the inherent cost of concurrency on the slow-path thus establishing an interesting, but intuitive complexity separation between progressive STMs and HyTMs.
Moreover, to the best of our knowledge, this is the first work to consider the theoretical foundations of the cost of concurrency in HyTMs in theory and practice (on currently available HTM architectures).

The proof of Theorem~\ref{th:impossibility} is based on the analogous proof for step complexity of STMs that are \emph{disjoint-access parallel}~\cite{prog15-pact, tm-book}.
Our model extends the HyTM model in \cite{hytm14disc} which did not allow direct accesses on the fast-path.

\cite{kumarhytm} described an implementation that requires support for direct accesses in a hardware transaction. 
Our implementation of Hybrid NOrec follows \cite{hynorecriegel}, which additionally proposed the use of direct accesses
in fast-path transactions to reduce instrumentation overhead in the AMD ASF architecture.

\vspace{1mm}\noindent\textbf{Beyond the two path HyTM approach.}
\vspace{1mm}\noindent\textit{Employing an uninstrumented fast fast-path.}
We now describe how every transaction may first be executed in a ``fast'' fast-path with almost no instrumentation
and if unsuccessful, may be re-attempted in the fast-path and subsequently in slow-path.
Specifically, we transform any opaque HyTM $\mathcal{M}$ to an opaque
HyTM $\mathcal{M}'$ in which a shared \emph{fetch-and-add} metadata base object $F$ that slow-path updating transactions
increment (and resp. decrement) at the start (and resp. end). In $\mathcal{M}'$, a ``fast'' fast-path transaction checks first checks if $F$ is $0$
and if not, aborts the transaction; otherwise the transaction is continued as an uninstrumented hardware transaction.
The code for the fast-path and the slow-path is identical to $\mathcal{M}$.
Assuming the hardware transactions do not perform any direct accesses, opacity is immediate.
\trevor{cite my BA at disc that effectively came up with this idea?}

\vspace{1mm}\noindent\textit{Other approaches.}
Recent work has investigated fallback to \emph{reduced} hardware transactions~\cite{MS13}
in which an all-software slow-path is replaced by a mix of hardware and software transactions. 
Afek \emph{et al}. proposed amalgamated lock elision (ALE)~\cite{ale15} which improves over TLE
by executing the slow-path as a series of segments, each of which is a dynamic length hardware transaction.

\vspace{1mm}\noindent\textbf{Concluding remarks.}